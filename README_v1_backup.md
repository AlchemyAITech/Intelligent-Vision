# 智能视界 — 图像处理与人工智能实验室

## 项目简介

这是一个基于 Streamlit 的交互式教学平台，旨在帮助学生直观地理解图像处理、计算机视觉和深度学习的核心概念。

本项目包含五个主要模块：

1. **🎨 图像的本质**: 探索 RGB, HSV, YCbCr, Lab 等色彩空间的转换与通道分离。
2. **⚙️ 卷积实验室**: 可视化卷积操作（滤波）如何提取图像特征（边缘、模糊、锐化等）。
3. **🧠 神经网络实验室**: 构建并训练一个 CNN 模型来识别手写数字 (MNIST)，支持实时训练过程和特征图可视化。
4. **👁️ YOLO 实验室**: 体验最先进的 YOLO 目标检测、图像分割、姿态估计和 SAM 零样本分割。
5. **👤 人脸实验室**: 集成 MediaPipe 与 Facenet，实现人脸检测、478点稠密网格、人脸识别、黑名单预警以及人脸库管理。

## 项目结构

```
code/
├── convolution_app.py  # 主应用程序入口
├── images/             # 存放示例图片
│   └── uploads/        # 存放用户上传的图片/视频
├── models/             # 存放模型文件 (.pt, .tflite, .task)
├── src/                # 核心逻辑源代码
│   ├── image_ops.py    # 图像卷积操作
│   ├── network.py      # PyTorch 网络模型定义
│   ├── utils.py        # 辅助函数 (UI, 绘图)
│   ├── yolo_manager.py # YOLO 模型管理与推理封装
│   ├── sam_manager.py  # SAM 模型管理
│   └── face_manager.py # 人脸分析管理
├── data/               # 存放数据
│   ├── mnist/          # MNIST 数据集
│   └── face_bank/      # 人脸库 (图片与特征)
├── readme.md           # 项目说明
└── requirements.txt    # 依赖列表
```

## 安装与运行

### 1. 环境准备 (推荐)

本项目推荐使用 Python 3.9+。建议创建虚拟环境：

```bash
python -m venv .venv
source .venv/bin/activate  # macOS/Linux
```

### 2. 安装依赖

由于部分库存在版本冲突，安装时请确保网络畅通：

```bash
pip install -r requirements.txt
```

### 3. 运行应用

```bash
streamlit run convolution_app.py
```

## 功能说明

### 1. 🎨 图像基础与卷积操作
* **色彩空间**: 支持 RGB, HSV, YCbCr, 灰度图等 4+ 色彩空间转换，支持中心 20x20 像素矩阵实时数值观测。
* **卷积实验室**: 内置边缘检测 (Sobel, Canny)、图像平滑 (Mean, Gaussian)、锐化等 10+ 种卷积核，支持自定义参数实时预览处理结果。

### 2. 🧠 神经网络实验室 (PyTorch)
* **动态架构**: 支持交互式调整 CNN 层数及通道数，实时重新加载模型。
* **可视化训练**: 实时绘制 Loss/Accuracy 曲线，动态同步展示特征图 (Feature Maps) 与预测概率分布图。

### 3. 👁️ YOLO & SAM 视觉大任务
* **全能 YOLO**: 集成检测 (Detect)、分割 (Segment)、姿态估计 (Pose) 三大任务，支持 YOLOv8/v11 以及高性能 yolo26 系列。
* **智能追踪**: 内置 **ByteTrack** 与 **BoT-SORT** 算法，实现 ID 连续的目标追踪，支持轨迹可视化 (Trails) 与同 ID 色彩同步。
* **万物分割 (SAM 2/3)**: 
  * **交互标注**: 支持通过“点 (Points)”、“框 (Boxes)”或“轮廓 (Lasso)”进行零样本 (Zero-shot) 分割。
  * **全图自动**: 一键识别并分割图片中的所有显著物体。
  * **视频分析**: 支持 SAM 2/3 在视频流中的目标稳定锁定与追踪。

### 4. 👤 人脸与手势分析 (AI Lab)
* **人脸分析**:
  * **高精度网格**: 基于 MediaPipe 实时 478 个人脸稠密关键点检测。
  * **智能识别**: 集成 Facenet 特征提取与余弦距离比对，支持黑名单检测与**红色预警光晕**呼吸效果。
  * **库管理**: 交互式管理人员姓名与照片，支持视频流中一键抓拍、自动持久化入库。
* **手势实验室**: 
  * **骨架检测**: 21 点手部关键点实时追踪。
  * **静态/动态手势**: 识别点赞、OK、胜利、数字等常用手势词汇。
  * **自定义手势**: 支持自定义手势样板录入，基于 Few-shot Learning 实现简单的个性化手势匹配。

## 算法详解 (技术点)

1. **人脸特征提取**: 裁剪人脸并由 **InceptionResnetV1** 转化为 512 维特征向量。
2. **相似度比对**: 计算实时特征与人脸库向量的 **余弦距离 (Cosine Distance)**，低于阈值即识别成功。
3. **卷积计算**: 离散卷积公式解析，通过滑窗乘加运算实现空间特征提取。
4. **可视化教学**: 重点展示层深度、卷积核步长 (Stride) 与特征感受野的关系。
